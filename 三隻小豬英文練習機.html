<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ä¸‰éš»å°è±¬è‹±æ–‡ç·´ç¿’æ©Ÿ</title>

<style>
body{
    font-family:"Microsoft JhengHei",sans-serif;
    background:#F4F2F0;
    padding:40px;
    display:flex;
    justify-content:center;
}

.container{
    max-width:800px;
    width:90%;
}

/* æ¨™é¡Œ */
h1{
    text-align:center;
    font-size:32px;
    color:#534F4A;
    margin-bottom:6px;
}

/* Tabs */
.tabs{
    display:flex;
    gap:10px;
    margin-bottom:20px;
}

.tabs button{
    flex:1;
    padding:10px;
    font-size:18px;
    border:none;
    border-radius:12px;
    background:#D6CBC1;
    color:#555;
    cursor:pointer;
}
.tabs button.active{
    background:#C8BDB3;
    font-weight:bold;
}

/* ä¸»å–®å­— */
.word{
    font-size:48px;
    font-weight:bold;
    margin-bottom:8px;
}

/*** éŸ³ç¯€é¡¯ç¤º ***/
.syllable{
    margin-left:20px;
    margin-bottom:8px;
}

/* éŸ³ç¯€éæ¯éŸ³ï¼ˆç°ï¼‰ */
.syll-gray{
    color:#9B9B9B;
}

/* æ¯éŸ³ highlightï¼ˆè«è˜­è¿ªç´…ï¼‰ */
.syll-vowel{
    color:#C27C88;
    font-weight:bold;
}

/* ä¸­æ–‡ */
.mean{
    margin-left:20px;
    font-size:16px;
    margin-bottom:8px;
}

/* ä¾‹å¥ */
.example{
    margin-left:20px;
    font-size:18px;
    margin-bottom:20px;
}
.example-word{
    color:#C27C88;
    font-weight:bold;
}

/* Buttons */
button.action,button.next{
    padding:10px 18px;
    margin:4px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    color:white;
    font-size:18px;
}

button.action{
    background:#B8AFA5;
}
button.action:hover{
    background:#A69D95;
}

button.next{
    background:#9A8F88;
}
button.next:hover{
    background:#8F857E;
}

/* è½å¯«éƒ¨åˆ† */
#dictInput{
    width:100%;
    font-size:22px;
    padding:10px;
    border-radius:10px;
    border:1px solid #AAA;
    margin-top:10px;
}

#done{
    font-size:32px;
    text-align:center;
    color:#6A5F58;
    display:none;
    margin-top:20px;
}

#restartBtn{
    display:none;
    padding:12px 18px;
    margin:20px auto;
    border:none;
    border-radius:10px;
    background:#8A7F76;
    color:white;
    font-size:20px;
    cursor:pointer;
}
#restartBtn:hover{
    background:#7A7068;
}

/* çµæœ */
#summaryBlock, #wrongBlock{
  display:none;
  background:#E7E4E1;
  padding:12px;
  border-radius:10px;
  margin-top:10px;
  font-size:16px;
  line-height:1.6;
}

.correct{ color:#3FA63F; font-weight:bold; }
.wrong{ color:#D9534F; font-weight:bold; }
</style>
</head>

<body>
<div class="container">

<h1>ä¸‰éš»å°è±¬è‹±æ–‡ç·´ç¿’æ©Ÿ</h1>

<!-- Tabs -->
<div class="tabs">
  <button id="tCard" class="active">å–®å­—å¡</button>
  <button id="tDict">è½å¯«</button>
</div>

<!-- å–®å­—å¡ -->
<div id="cardSec">
  <div id="cWord" class="word"></div>

  <div id="cSyl" class="syllable"></div>
  <div id="cMean" class="mean"></div>
  <div id="cEx" class="example"></div>

  <button class="action" onclick="speakWord()">é»æˆ‘è½å–®å­—</button>
  <button class="action" onclick="speakEx()">é»æˆ‘è½ä¾‹å¥</button>
  <button class="next" onclick="nextCard()">ä¸‹ä¸€å€‹å–®å­—</button>
</div>

<!-- è½å¯« -->
<div id="dictSec" style="display:none;">
  <div id="dictTitle" style="font-size:18px;margin-bottom:10px;">
    è½ä¸€è½ï¼Œæ‹¼å‡ºå–®å­—ï¼ŒæŒ‰ä¸‹ enter é€²å…¥ä¸‹ä¸€é¡Œ
  </div>

  <button class="action" id="listenBtn" onclick="speakDict()">å†è½ä¸€æ¬¡</button>
  <div id="hint" style="margin:8px 0;color:#555;"></div>

  <input id="dictInput" placeholder="è«‹è¼¸å…¥è‹±æ–‡">

  <div id="done">ğŸ‰ æ­å–œå®Œæˆæœ¬æ¬¡è½å¯«ï¼</div>

  <div id="summaryBlock"></div>
  <div id="wrongBlock"></div>

  <button id="restartBtn" onclick="restartDict()">å†åšä¸€æ¬¡</button>
</div>


<script>
/* ------------------------------------------------
   èªéŸ³ï¼ˆå¥³æ€§ç¾èª, 0.75xï¼‰
-------------------------------------------------- */
let femaleVoice=null;
function loadVoices(){
    let list=speechSynthesis.getVoices();
    femaleVoice =
        list.find(v=>v.name.toLowerCase().includes("female")) ||
        list.find(v=>v.name.includes("Google US English")) ||
        list[0];
}
speechSynthesis.onvoiceschanged=loadVoices;
loadVoices();

/* ------------------------------------------------
   å–®å­—è³‡æ–™ï¼ˆç¤ºç¯„ 3 å­—ï¼Œä½ æœƒæ”¾ 40 å­—ï¼‰
-------------------------------------------------- */
const wordList=[
 {word:"farm", zh:"è¾²å ´", syll:["farm"], example:`We visited a <span class='example-word'>farm</span> last weekend.`},
 {word:"city", zh:"åŸå¸‚", syll:["cit","y"], example:`I live in a busy <span class='example-word'>city</span>.`},
 {word:"ring", zh:"æˆ’æŒ‡", syll:["ring"], example:`She wore a shiny <span class='example-word'>ring</span> today.`}
];

/* ------------------------------------------------
   å°å·¥å…·
-------------------------------------------------- */
function shuffle(arr){
    for(let i=arr.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]]=[arr[j],arr[i]];
    }
}

/* ------------------------------------------------
   éŸ³ç¯€æ¸²æŸ“ï¼ˆç°å­— + æ¯éŸ³ç´…ï¼‰
-------------------------------------------------- */
function renderSyll(sArr){
 const vowels="aeiou";
 return sArr.map(s=>{
   let out="";
   for(let ch of s){
     if(vowels.includes(ch)){
       out+=`<span class="syll-vowel">${ch}</span>`;
     }else{
       out+=`<span class="syll-gray">${ch}</span>`;
     }
   }
   return out;
 }).join(" ");
}

/* ------------------------------------------------
   ä¸»å–®å­—å¡
-------------------------------------------------- */
let cardOrder=[...wordList];
shuffle(cardOrder);
let ci=0;

function colorize(w){
 let res="", v="aeiou";
 for(let ch of w){
   if(v.includes(ch)) res+=`<span style="color:#C27C88">${ch}</span>`;
   else res+=`<span style="color:#4A708B">${ch}</span>`;
 }
 return res;
}

function loadCard(){
 let o=cardOrder[ci];
 cWord.innerHTML=colorize(o.word);
 cSyl.innerHTML=renderSyll(o.syll);
 cMean.innerHTML="ä¸­æ–‡ï¼š"+o.zh;
 cEx.innerHTML=o.example;
}

function speakWord(){
 let u=new SpeechSynthesisUtterance(cardOrder[ci].word);
 u.lang="en-US"; u.rate=0.75; u.voice=femaleVoice;
 speechSynthesis.cancel(); speechSynthesis.speak(u);
}

function speakEx(){
 let raw=cEx.innerText;
 let u=new SpeechSynthesisUtterance(raw);
 u.lang="en-US"; u.rate=0.75; u.voice=femaleVoice;
 speechSynthesis.cancel(); speechSynthesis.speak(u);
}

function nextCard(){
 ci++;
 if(ci>=cardOrder.length){
   shuffle(cardOrder);
   ci=0;
 }
 loadCard();
 speakWord();
}

/* ------------------------------------------------
   è½å¯«
-------------------------------------------------- */
let dictOrder=[], di=0, playCount=0;
let answers=[];

function initDict(){
 dictOrder=[...wordList];
 shuffle(dictOrder);
 di=0; playCount=0; answers=[];

 dictTitle.style.display="block";
 listenBtn.style.display="inline-block";
 dictInput.style.display="block";
 hint.style.display="block";
 done.style.display="none";
 restartBtn.style.display="none";
 summaryBlock.style.display="none";
 wrongBlock.style.display="none";

 dictInput.value="";
 hint.innerHTML="";
}

function speakDict(){
 let u=new SpeechSynthesisUtterance(dictOrder[di].word);
 u.lang="en-US"; u.rate=0.75; u.voice=femaleVoice;
 speechSynthesis.cancel(); speechSynthesis.speak(u);

 playCount++;
 if(playCount>=3){
   hint.innerHTML="æç¤ºï¼š"+dictOrder[di].zh;
 }
}

dictInput.addEventListener("keydown",e=>{
 if(e.key==="Enter") nextDict();
});

function nextDict(){
 let user=dictInput.value.trim();
 let correct=dictOrder[di].word;
 answers.push({user,correct});

 di++;
 if(di>=dictOrder.length){
   finishDict();
   return;
 }

 playCount=0;
 hint.innerHTML="";
 dictInput.value="";
 speakDict();
}

function finishDict(){
 dictInput.style.display="none";
 listenBtn.style.display="none";
 hint.style.display="none";
 dictTitle.style.display="none";

 done.style.display="block";
 restartBtn.style.display="block";

 let total=answers.length;
 let correctN=answers.filter(a=>a.user.toLowerCase()===a.correct).length;
 let wrongN=total-correctN;

 summaryBlock.innerHTML=
   `å…±ç­” ${total} é¡Œã€€`+
   `ç­”å°ï¼š<span class='correct'>${correctN}</span> é¡Œã€€`+
   `ç­”éŒ¯ï¼š<span class='wrong'>${wrongN}</span> é¡Œ`;

 summaryBlock.style.display="block";

 let wrongs=answers.filter(a=>a.user.toLowerCase()!==a.correct);
 if(wrongs.length>0){
   let html="";
   wrongs.forEach(w=>{
     html+=`<div><span class='wrong'>${w.user||"(ç©ºç™½)"}</span> âœ æ­£ç¢ºï¼š${w.correct}</div>`;
   });
   wrongBlock.innerHTML=html;
   wrongBlock.style.display="block";
 }
}

function restartDict(){
 initDict();
 speakDict();
}

/* ------------------------------------------------
   Tab åˆ‡æ›
-------------------------------------------------- */
tCard.onclick=function(){
 tCard.classList.add("active");
 tDict.classList.remove("active");
 cardSec.style.display="block";
 dictSec.style.display="none";
 loadCard();
}

tDict.onclick=function(){
 tDict.classList.add("active");
 tCard.classList.remove("active");
 cardSec.style.display="none";
 dictSec.style.display="block";
 initDict();
 speakDict();
}

loadCard();
</script>

</div>
</body>
</html>
